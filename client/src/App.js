import React, { useState } from "react";
import User from "./User/User";
import LandingPage from "./Landing Page/LandingPage";
import Login from "./Landing Page/Auth/Login";
import Register from "./Landing Page/Auth/Register";
import { motion, AnimatePresence } from "framer-motion";
import Modal from "./Modal";

import { BrowserRouter as Router, Switch, Route } from "react-router-dom";
import "./styles/style.css";
import { useEffect } from "react";

function App() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);
  const [showModal, setShowModal] = useState(false);

  useEffect(() => {
    // localStorage.setItem(isLoggedIn, false);
    const temp = JSON.parse(localStorage.getItem(isLoggedIn));
    console.log(temp);
    if (temp) {
      setIsLoggedIn(temp);
    }
  });

  return (
    <>
      <Router>
        <Modal showModal={showModal} />

        <Route
          render={({ location }) => (
            <AnimatePresence
              exitBeforeEnter
              onExitComplete={() => setShowModal(false)}
            >
              <Switch location={location} key={location.pathname}>
                {isLoggedIn ? (
                  <>
                    <User setShowModal={setShowModal} showModal={showModal} />
                  </>
                ) : (
                  <LandingPage
                    isLoggedIn={isLoggedIn}
                    setIsLoggedIn={setIsLoggedIn}
                    setShowModal={setShowModal}
                  />
                )}
              </Switch>
            </AnimatePresence>
          )}
        />
      </Router>
    </>
  );
}

export default App;
